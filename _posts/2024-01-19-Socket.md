---
layout: single
title:  "[Java] Socket"
typora-root-url: ../
---


ê°„ë‹¨í•œ ì†Œì¼“ í†µì‹ ì„ í†µí•´ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ ì±„íŒ…ì„ êµ¬í˜„í•˜ëŠ” ì˜ˆì œë¥¼ í†µí•´ ê³µë¶€ë¥¼ í•´ë³´ì•˜ë‹¤.
ê¹Œë¨¹ì§€ ì•Šê¸° ìœ„í•´ ê¸°ë¡ ê¸°ë¡....ğŸ‘€


```
package com.example.test;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Iterator;
import java.util.Vector;

class Server extends Thread {
    /*
    Server class
    ì„œë²„ ì—­í• ì„ í•˜ëŠ” í´ë˜ìŠ¤. í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ê³  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ë“¤ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•¨.
     */

    Vector<ClientHandler> clientList = new Vector<>();

    /*
    VectorëŠ” ìë°”ì—ì„œ ì œê³µí•˜ëŠ” ë™ê¸°í™”ëœ ì»¬ë ‰ì…˜ í´ë˜ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ ìŠ¤ë ˆë“œ ê°„ì— ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë™ê¸°í™” ë¼ ìˆìŒ.
    VectorëŠ” ë°°ì—´ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ í¬ê¸°ê°€ ë™ì ìœ¼ë¡œ ì¡°ì ˆë˜ë©° ë™ê¸°í™”ê°€ ë³´ì¥ë˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    ì„œë²„ì— ì—°ê²°ëœ ê° í´ë¼ì´ì–¸íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ì¸ ClientHandler ê°ì²´ë¥¼ ë‹´ëŠ” Vectorë¥¼ ìƒì„±í•œë‹¤.
    Vectorë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìˆ˜ì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ë™ì‹œì— ì„œë²„ì— ì—°ê²°ë˜ê³  ì„œë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì´ ë²¡í„°ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
    ë™ê¸°í™”ëœ ìë£Œ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•´ ìŠ¤ë ˆë“œ ì•ˆì „ì„±ì„ ë³´ì¥í•˜ë ¤ëŠ” ëª©ì ì´ë‹¤.

     */

    ServerSocket ss;
    boolean running = true;

    public void run() { // ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì •ì˜í•˜ëŠ” ë©”ì„œë“œ. ì•ˆì˜ ë¡œì§ì€ ìŠ¤ë ˆë“œê°€ ì‹œì‘ë˜ë©´ ì‹¤í–‰ ë¨.
        try {
            ss = new ServerSocket(8090); // ServerSocket ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ìˆ˜ë½í•  ì¤€ë¹„
            // new ServerSocket(0) ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ í¬íŠ¸ë¥¼ ìë™ìœ¼ë¡œ í• ë‹¹
            System.out.println("Server running on port: " + ss.getLocalPort());
            while (running && !Thread.currentThread().isInterrupted()) {
                System.out.println("Waiting client...");
                Socket s = ss.accept(); // accept()ì„ í˜¸ì¶œ, í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²° ìš”ì²­ì„ í•  ë•Œê¹Œì§€ ë¸”ë¡ë¨.

                /**
                 *    public Socket accept() throws IOException {
                 *         if (isClosed()) // ì†Œì¼“ì´ ë‹«í˜”ëŠ”ê°€?
                 *             throw new SocketException("Socket is closed");
                 *         if (!isBound()) // ì†Œì¼“ì´ ë°”ì¸ë”© ë˜ì—ˆëŠ”ê°€? ==> í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ìˆ˜ë½í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ê°€?
                 *             throw new SocketException("Socket is not bound yet");
                 *         Socket s = new Socket((SocketImpl) null);
                 *         implAccept(s);
                 *         return s;
                 *     }
                 *   ==> ServerSocket ì—ì„œ ì œê³µë˜ëŠ” ë©”ì„œë“œë¡œ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì‹¤ì œ ì—°ê²°ì´ ìˆ˜ë½ë˜ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹ í•  ìˆ˜ ìˆëŠ” Socketê°ì²´ë¥¼ ë°˜í™˜í•¨.
                 *         ì—°ê²° ìš”ì²­ì´ ì—†ëŠ” ê²½ìš°ì—ëŠ” ë¸”ë¡ë˜ì–´ ëŒ€ê¸°,
                 */

                // í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ì„ ì‹œë„í•˜ë©´ `accept`ëŠ” í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹ í•  ìˆ˜ ìˆëŠ” Socket ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
                System.out.println("Client connected.");

                /*
                thisëŠ” í˜„ì¬ Server ê°ì²´ë¥¼ ê°€ë¥´í‚¨ë‹¤.
                ClientHandlerê°€ ìƒì„±ìì—ì„œ thisë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì—°ê²°ë˜ì—ˆì„ ë•Œ,
                ì´ í´ë¼ì´ì–¸íŠ¸ì™€ ê´€ë ¨ëœ ì‘ì—…ì„ Server ê°ì²´ì˜ ë©”ì„œë“œ ë“±ì„ í†µí•´ ìˆ˜í–‰í•˜ê¸° ìœ„í•¨ì´ë‹¤.
                ==> ì¦‰, ìƒì„±ìë¥¼ í†µí•´ 'Server' ê°ì²´ë¥¼ ì „ë‹¬ë°›ì•„ 'ClientHandler' ê°ì²´ê°€ í•´ë‹¹ ì„œë²„ì˜ ê¸°ëŠ¥ì„ í™œìš©í•  ìˆ˜ ìˆëŠ” ê²ƒ.
                    ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ í†µì‹ ì„ ê´€ë¦¬í•˜ê³  ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŒ…í•˜ëŠ” ë“±ì˜ ì‘ì—…ì„
                    'Server'ê°ì²´ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ.
                 */
                ClientHandler client = new ClientHandler(this, s);
                /*
                í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì—°ê²°ì´ ìˆ˜ë½ë˜ë©´ `ClientHandler` í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ ,
                clientListì— ì´ í´ë¼ì´ì–¸íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•œë‹¤.
                */
                clientList.add(client);
                /*
                clientì˜ start()ëŠ” ClientHandlerì˜ ë©”ì„œë“œê°€ ì•„ë‹ˆë¼ Threadì˜ ë©”ì„œë“œì´ë‹¤.
                ClientHandlerëŠ” Threadë¥¼ ìƒì†ë°›ì•˜ê¸° ë•Œë¬¸ì— start()ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê²ƒ.

                public void start() {
                    synchronized (this) {
                        // zero status corresponds to state "NEW".
                        if (holder.threadStatus != 0)
                            throw new IllegalThreadStateException();
                        start0();
                    }
                }

                ==> start()ëŠ” ìŠ¤ë ˆë“œë¥¼ ì‹œì‘í•˜ëŠ” ì—­í• ì„ í•œë‹¤.
                start()ë¥¼ í˜¸ì¶œí•˜ë©´ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œê°€ ìƒì„±ë˜ì–´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
                í•œë²ˆ ìŠ¤ë ˆë“œê°€ ì‹œì‘ë˜ë©´ ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ì—†ìœ¼ë©°, ì´ë¯¸ ì‹œì‘ëœ ìŠ¤ë ˆë“œë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ë ¤ê³  í•˜ë©´ IllegalThreadStateExceptionê°€ ë°œìƒí•¨.
                synchronized (this)ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— start()ë¥¼ í˜¸ì¶œí•˜ì§€ ëª»í•˜ë„ë¡ ë™ê¸°í™”ë¥¼ ì œê³µí•¨.
                start0() ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ì „ì— synchronized (this) ë¸”ë¡ ë‚´ì—ì„œ í˜„ì¬ ìŠ¤ë ˆë“œì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ê³ , ì´ë¯¸ ì‹œì‘ëœ ìŠ¤ë ˆë“œì¸ì§€ í™•ì¸í•¨.
                start0() ë©”ì„œë“œëŠ” ì‹¤ì œë¡œ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ì‘ì„±ëœ ë©”ì„œë“œë¡œ ìŠ¤ë ˆë“œë¥¼ ì‹œì‘í•˜ëŠ” ë¡œìš° ë ˆë²¨ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.

                í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ í†µì‹ ì„ ë‹´ë‹¹í•  ìƒˆë¡œìš´ ìŠ¤ë ˆë“œë¡œ ì‹œì‘í•˜ëŠ” ì‹œì ì€ start()í•  ë•Œì„!!!!!!!!!!
                start() ==> start0() ==> Threadë¥¼ ìƒì†ë°›ì€ ClientHandlerì˜ run() ==>
                 */
                client.start();
            }
        } catch (Exception e) {
            System.out.println("Server - error occurred. system will be down.");
            System.out.println("Error in ClientHandler.run(): " + e.getMessage());
            shutdown();
            /*
            ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ í•´ë‹¹ ì˜ˆì™¸ë¥¼ ìºì¹˜í•˜ê³  ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•œë‹¤.
            ê·¸ í›„ shutdown ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì„œë²„ ë° í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ì¢…ë£Œí•¨.
            */
        }
    }

    void shutdown() {
        this.running = false;
        Iterator<ClientHandler> it = clientList.iterator();
        while (it.hasNext()) {
            ClientHandler client = it.next();
            client.disconnect();
            it.remove();
        }
        if (ss != null) try { ss.close(); } catch (Exception e) {}
    }

    void broadcast(String s) {
        for (ClientHandler client : clientList) {
            client.sendMessage(s);
        }
    }

}

class ClientHandler extends Thread {

    Server server;
    boolean running = true;
    Socket socket;
    BufferedReader in;
    PrintWriter out;

    public ClientHandler(Server server, Socket s) throws Exception {
        this.server = server;
        this.socket = s;
    }

    void disconnect() {
        System.out.println("ClientHandler.disconnect()");
        running = false;
        if (in != null) try { in.close(); } catch (Exception e) {}
        if (out != null) try { out.close(); } catch (Exception e) {}
        server.clientList.remove(this);
    }

    // sendMessage()ëŠ” ì„œë²„ì—ì„œ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ëŠ” ì—­í• ì„ í•¨.
    void sendMessage(String msg) {
        out.println(msg);
        out.flush();
    }

    public void run() {
        try {
            System.out.println("ClientHandler.run()");
            // í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì—°ê²°ëœ ì†Œì¼“ì—ì„œ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ì–»ì–´ì˜¨ë‹¤.
            out = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()));
            // í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì—°ê²°ëœ ì†Œì¼“ì—ì„œ ì…ë ¥ ìŠ¤íŠ¸ë¦¼ì„ ì–»ì–´ì˜¨ë‹¤.
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            out.println("Welcome!");
            out.flush(); // ë²„í¼ì— ë‚¨ì•„ìˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ë¹„ì›Œì¤˜ì•¼í•¨. ì•ˆë¹„ìš°ë©´ ë©”ì‹œì§€ ì¶œë ¥ ì•ˆ ë  ìˆ˜ë„ ìˆìŒ.
        } catch (Exception e) {
            System.out.println("error occurred.");
            e.printStackTrace();
        }

        while (running && !Thread.currentThread().isInterrupted()) { // í´ë¼ì´ì–¸íŠ¸ê°€ ê³„ì†í•´ì„œ ì—°ê²°ì¤‘ì´ë¼ë©´? 
            try {
                String line = in.readLine(); // ì…ë ¥ ë°›ì•„ì„œ 
                System.out.println("message received - " + line); // ì¶œë ¥
                if ("exit".equals(line)) { // ë§Œì•½ì— exitë¥¼ ì…ë ¥í–ˆë‹¤ë©´ breakí•˜ê³  disconnet() í˜¸ì¶œ
                    // ==> í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì˜ ClientHandler ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë˜ê³ , í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì™€ì˜ ì—°ê²° ëŠì–´ì§
                    break;
                }
                if ("down".equals(line)) { // downì„ ì…ë ¥í–ˆë‹¤ë©´ shutdown() ==> disconnet() í˜¸ì¶œ
                    server.shutdown(); // exception
                    // ==> ì „ì²´ ì„œë²„ ì¢…ë£Œ, ë‹¹ì—°íˆ ClientHandler ìŠ¤ë ˆë“œë„ ì¢…ë£Œ
                    break;
                }

                // ë§Œì•½ exitì™€ down ì™¸ì˜ ì…ë ¥ê°’ì´ ë“¤ì–´ì˜¨ë‹¤ë©´ broadcast()ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì…ë ¥í•œ ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ë³´ëƒ„
                server.broadcast(line);
            } catch (Exception e) {
                System.out.println("error occurred. connection will be closed.");
                e.printStackTrace();
                break;
            }
        }
        disconnect();
    }

}

class ConsoleClient extends Thread {

    boolean running = true;
    Socket socket;
    BufferedReader in;
    PrintWriter out;
    ConsoleReader console;

    public ConsoleClient() throws Exception {
        this.socket = new Socket("localhost", 8090);
        this.console = new ConsoleReader(this);
        this.console.start();
    }

    void sendMessage(String message) {
        System.out.println("ConsoleClient.sendMessage: " + message);
        out.println(message);
        out.flush();
    }

    void disconnect() {
        System.out.println("ConsoleClient.disconnect()");
        running = false;
        if (in != null) try { in.close(); } catch (Exception e) {}
        if (out != null) try { out.close(); } catch (Exception e) {}
        console.shutdown();
    }

    public void run() {
        System.out.println("ConsoleClient.run()");
        try {
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            out = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()));
        } catch (Exception e) {
            System.out.println("error occurred.");
            e.printStackTrace();
            running = false;
        }
        System.out.println("stream created.");
        while (running && !Thread.currentThread().isInterrupted()) {
            try {
                String line = in.readLine();
                if (line == null) {
                    disconnect();
                    break;
                }
                System.out.println(line);
            } catch (Exception e) {
                System.out.println("ConsoleClient - error occurred. system will be down.");
                System.out.println("Error in ClientHandler.run(): " + e.getMessage());
                e.printStackTrace();
                running = false;
                break;
            }
        }
    }

}

class ConsoleReader extends Thread {
    ConsoleClient cc;
    boolean running = true;
    ConsoleReader(ConsoleClient cc) {
        this.cc = cc;
    }
    void shutdown() {
        running = false;
        this.interrupt();
    }
    public void run() {
        System.out.println("ConsoleReader.run()");
        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        try {
            while (running
                    && !Thread.currentThread().isInterrupted()) {
                System.out.print("input: ");
                String line = in.readLine();
                if (line == null) {
                    running = false;
                    cc.disconnect();
                    break;
                }
                System.out.println("> " + line);
                cc.sendMessage(line);
            }
        } catch (Exception e) {
            System.out.println("Error in ConsoleReader.run(): " + e.getMessage());
            e.printStackTrace();
        }
    }
}

public class SocketTest {
    public static void main(String[] args) throws Exception {
        if (args.length > 0) {
            if ("server".equals(args[0])) {
                new Server().start();
            } else if ("client".equals(args[0])) {
                new ConsoleClient().start();
            }
        } else {
            System.out.println("ì‚¬ìš©ë²•: java SocketTest <server/client>");
        }
    }
}

```



**`Server Class` í´ë˜ìŠ¤:**

- `Server` í´ë˜ìŠ¤ëŠ” ì„œë²„ ì—­í• ì„ í•˜ëŠ” í´ë˜ìŠ¤ë¡œ, í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ê³  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ë“¤ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•œë‹¤.

- ì„œë²„ëŠ” `ServerSocket`ì„ ì‚¬ìš©í•˜ì—¬ run()ì— íŠ¹ì • í¬íŠ¸(ì—¬ê¸°ì„œëŠ” 8088)ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ìˆ˜ë½í•œë‹¤.

  ==> ë¬´í•œ ë£¨í”„ì¸ ì´ìœ ëŠ” ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•¨ì„.

- `Server` í´ë˜ìŠ¤ëŠ” `ClientHandler` ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ í†µì‹ ì„ ì²˜ë¦¬í•œë‹¤.



**`ClientHandler` í´ë˜ìŠ¤:**

- `ClientHandler` í´ë˜ìŠ¤ëŠ” ê° í´ë¼ì´ì–¸íŠ¸ì˜ í†µì‹ ì„ ì²˜ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œì´ë‹¤.
- ê° í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì…ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ì—¬ ì„œë²„ì— ë¸Œë¡œë“œìºìŠ¤íŒ…í•œë‹¤.
- í´ë¼ì´ì–¸íŠ¸ê°€ "exit"ì„ ë³´ë‚´ë©´ í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì˜ ìŠ¤ë ˆë“œë¥¼ ì¢…ë£Œí•˜ê³  ì—°ê²°ì„ ë‹«ëŠ”ë‹¤.
- "down"ì„ ë°›ìœ¼ë©´ ì„œë²„ë¥¼ ì¢…ë£Œì‹œí‚¤ê³  í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ë„ ì¢…ë£Œí•œë‹¤.



**`ConsoleClient` ë° `ConsoleReader` í´ë˜ìŠ¤:**

- `ConsoleClient` í´ë˜ìŠ¤ëŠ” í´ë¼ì´ì–¸íŠ¸ ì—­í• ì„ í•˜ëŠ” í´ë˜ìŠ¤ë¡œ, ì„œë²„ì— ì—°ê²°í•˜ì—¬ ì½˜ì†”ì—ì„œ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ê³  ì„œë²„ë¡œ ì „ì†¡í•œë‹¤.
- `ConsoleReader` í´ë˜ìŠ¤ëŠ” ì½˜ì†”ì—ì„œ ì…ë ¥ì„ ì½ì–´ì™€ì„œ ì„œë²„ë¡œ ì „ì†¡í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” ìŠ¤ë ˆë“œì´ë‹¤.



**`SocketTest` í´ë˜ìŠ¤ (ë©”ì¸ í´ë˜ìŠ¤):**

- `SocketTest` í´ë˜ìŠ¤ëŠ” í”„ë¡œê·¸ë¨ì˜ ì§„ì…ì ìœ¼ë¡œ, ëª…ë ¹í–‰ ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ ì„œë²„ ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.
- "server"ë¥¼ ì¸ìë¡œ ì£¼ë©´ ì„œë²„ë¡œ ë™ì‘í•˜ê³ , "client"ë¥¼ ì¸ìë¡œ ì£¼ë©´ í´ë¼ì´ì–¸íŠ¸ë¡œ ë™ì‘í•œë‹¤. 





## âœï¸`SocketTest` í´ë˜ìŠ¤ì˜ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ìˆœì„œ

1. **í”„ë¡œê·¸ë¨ ì‹¤í–‰:**

   - í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ ëª…ë ¹í–‰ ì¸ìë¡œ "server" ë˜ëŠ” "client"ë¥¼ ì „ë‹¬í•œë‹¤.
   - "server"ë¥¼ ì¸ìë¡œ ì£¼ë©´ ì„œë²„ë¡œ ë™ì‘í•˜ë©°, "client"ë¥¼ ì¸ìë¡œ ì£¼ë©´ í´ë¼ì´ì–¸íŠ¸ë¡œ ë™ì‘í•œë‹¤.
     ![image-20240124143131051](/images/2024-01-19-Socket/image-20240124143131051.png)


     ![image-20240124143223274](/images/2024-01-19-Socket/image-20240124143223274.png)

   

2. **ì„œë²„ ë™ì‘:**

   - "server"ë¥¼ ëª…ë ¹í–‰ ì¸ìë¡œ ë°›ì•˜ì„ ê²½ìš°, `Server` í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ìŠ¤ë ˆë“œë¡œ ì‹œì‘í•œë‹¤.
   - `Server` í´ë˜ìŠ¤ëŠ” `ServerSocket`ì„ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ê³ , ì—°ê²°ë˜ë©´ `ClientHandler` ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ í†µì‹ ì„ ë‹´ë‹¹í•œë‹¤.
   - ì„œë²„ëŠ” ë¸Œë¡œë“œìºìŠ¤íŒ…ì„ í†µí•´ ì—°ê²°ëœ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•œë‹¤.
   - "down" ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´ ì„œë²„ë¥¼ ì¢…ë£Œí•˜ê³  í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ë„ ì¢…ë£Œí•œë‹¤.

     

3. **í´ë¼ì´ì–¸íŠ¸ ë™ì‘:**

   - "client"ë¥¼ ëª…ë ¹í–‰ ì¸ìë¡œ ë°›ì•˜ì„ ê²½ìš°, `ConsoleClient` í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ìŠ¤ë ˆë“œë¡œ ì‹œì‘í•œë‹¤.
   - `ConsoleClient` í´ë˜ìŠ¤ëŠ” ì„œë²„ì— ì†Œì¼“ ì—°ê²°ì„ ì‹œë„í•˜ê³ , ì—°ê²°ì´ ì„±ê³µí•˜ë©´ `ConsoleReader` ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©ìì˜ ì½˜ì†” ì…ë ¥ì„ ì½ì–´ì™€ ì„œë²„ë¡œ ì „ì†¡í•œë‹¤.
   - ì„œë²„ì—ì„œ ë°›ì€ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— ì¶œë ¥í•œë‹¤.
   - "exit" ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•œë‹¤.
     

4. **í†µì‹  í”„ë¡œì„¸ìŠ¤:**

   - í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ë•ŒëŠ” `ConsoleClient`ì˜ `sendMessage` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.
   - ì„œë²„ëŠ” ë°›ì€ ë©”ì‹œì§€ë¥¼ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŒ…í•œë‹¤.
   - ì„œë²„ì—ì„œ "exit" ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´ í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì—°ê²°ì„ ì¢…ë£Œí•˜ê³ , "down" ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´ ì„œë²„ì™€ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ì¢…ë£Œí•œë‹¤.

   

   

   # âœï¸ ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ì

   1.  SocketTest.javaê°€ ìˆëŠ” ë””ë ‰í† ë¦¬ì—ì„œ cmdì°½ì„ ì—°ë‹¤.
      ==> ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•¨.
              D:\workspace_inteliJ\test\src\main\java\com\example\test>javac -encoding UTF-8 -d . SocketTest.java
      	ë‚˜ê°™ì€ ê²½ìš°ì—ëŠ” encoding ì˜¤ë¥˜ê°€ ë‚˜ì„œ -encoding UTF-8 ì˜µì…˜ì„ ì£¼ê³  ì»´íŒŒì¼ì„ í•¨. ì»´íŒŒì¼í•˜ê³ ë‚˜ë©´ classíŒŒì¼ì´ ìƒì„±ë  ê²ƒ.

   2. ì•„ë˜ ì‚¬ì§„ì²˜ëŸ¼ -cpë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë˜ìŠ¤ íŒ¨ìŠ¤ ìœ„ì¹˜ë¥¼ ì„¤ì •(JVMì´ í´ë˜ìŠ¤ íŒŒì¼ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ì„ ê²€ìƒ‰í•˜ëŠ” ê²½ë¡œë¥¼ ì§€ì •)í•´ì¤Œê³¼ ë™ì‹œì— SocketTest í´ë˜ìŠ¤ì— ì¸ìì¸ 'server' ì „ë‹¬, ì‹¤í–‰í•œë‹¤. ë‹¤ë¥¸ cmdì°½ì„ ì¼œì„œ ê°™ì€ ë°©ë²•ìœ¼ë¡œ clientë„ ì‹¤í–‰í•¨. 

      ![image-20240124144258193](/images/2024-01-19-Socket/image-20240124144258193.png)

   3. client ì°½ì—ì„œ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ë©´ server cmdì°½ì— ê·¸ëŒ€ë¡œ broadcastëœë‹¤.

      ![image-20240124144500597](/images/2024-01-19-Socket/image-20240124144500597.png)

      